# Vulnerability recurrence 

### The first loophole to reproduce is  CVE-2020-1021 

The code is based on an excellent vulnerability report  https://github.com/guhe120/Windows-EoP/blob/master/CVE-2020-1021/writeup.docx 

This code is only capable of triggering vulnerabilities wersvc!CWerService::SvcCollectMemoryInfo

My experimental environment is 1903 x64

I want to record something：

If the MaxMessageLength field in the fourth parameter ALPC_PORT_ATTRIBUTES of NtAlpcConnectPort is not set, then the length of the message sent by NtAlpcSendWaitReceivePort cannot exceed 0x200, and a 0xC000002F will be returned

If the sending length exceeds the maximum length specified by the server (NtAlpcSendWaitReceivePort is the third parameter from the bottom), you will get a 0xC0000707 

I cannot create a directory on C:\ProgramData\Microsoft\Windows\WER. Because I don’t have permission, I cannot set a symbolic link to Temp 

CreateFile will not be affected by disk storage space. WriteFile will 

Because the vulnerable component is wersvc.dll, you need to start the Windows error report first

Open cmd and enter the command: C:\Windows\System32\svchost.exe -k WerSvcGroup

Or start directly from the service application

You can enter the command tasklist /m wersvc.dll in cmd to determine whether this service is started.  

To debug svchost.exe, it is best to download symbols and then debug.Assume that the process id reported by the Windows error is 1234  

windbg：  
.process 0n1234 0  
.process /p eprocess  
.reload /f /user  
.process /p /i eprocess  
bp wersvc!CWerService::SvcCollectMemoryInfo  
g   
